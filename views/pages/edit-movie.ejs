<!DOCTYPE html>
<html lang="en">
	<head>
		<%- include('../partials/head'); %>
	</head>
	<body class="container">
		<header><%- include('../partials/header'); %></header>

		<main>
			<form id="editMovieForm">
				<div class="form-group">
					<label for="title">Title</label>
					<input
						type="text"
						class="form-control"
						id="title"
						value="<%= movie.title %>"
						name="movieTitle"
					/>
				</div>
				<div class="form-group">
					<label for="year">Year</label>
					<input
						type="text"
						class="form-control"
						id="year"
						value="<%= movie.year %>"
						name="movieYear"
					/>
				</div>
				<div class="form-group">
					<label for="category">Category</label>
					<input
						type="text"
						class="form-control"
						id="category"
						value="<%= movie.category %>"
						name="movieCategory"
					/>
				</div>
				<div class="form-group">
					<label for="rating">Rating</label>
					<input
						type="text"
						class="form-control"
						id="rating"
						value="<%= movie.rating %>"
						name="movieRating"
					/>
				</div>
				<button type="submit" class="btn btn-warning mb-2">Edit</button>
			</form>
			<button type="button" class="btn btn-danger mb-2" id="deleteBtn">
				Delete
			</button>
		</main>

		<footer><%- include('../partials/footer'); %></footer>
		<script>
			const editMovieForm = document.getElementById('editMovieForm');
			const deleteBtn = document.getElementById('deleteBtn');

			editMovieForm.addEventListener('submit', (e) => {
				e.preventDefault();
				const formData = new FormData(editMovieForm);
				const id = '<%= movie.id %>';
				fetch(`/api/v1/movies/${id}`, {
					method: 'PATCH',
					body: JSON.stringify(Object.fromEntries(formData)),
					headers: {
						'Content-Type': 'application/json',
					},
				});
			});
			deleteBtn.addEventListener('click', (e) => {
				e.preventDefault();
				const id = '<%= movie.id %>';
				fetch(`/api/v1/movies/${id}`, {
					method: 'DELETE',
					headers: {
						'Content-Type': 'application/json',
					},
				});
			});
		</script>
	</body>
</html>
